# -*- coding: utf-8 -*-
"""dataset_fichaensamblaje.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1O6Awf5d7BvBTd1IzniZ6ahv4UJ0d1NUG
"""

# Uso del Pip install para poder importar la librería faker
!pip install faker

# Importar librería pandas para manejar y analizar datos
import pandas as pd
# Importar librería uuid para crear identificadores únicos.
import uuid
# Importar librería random para generar datos aleatorios.
import random
# Importar el paquete faker para generar datos fasos.
from faker import Faker
# Importar la librería datetime para manejar fechas.
import datetime
from datetime import date

# Delimitación del rango del número de elementos.
num_ensamblar = 5000

#Instanciación faker
faker = Faker()

# Una lista de 5 características de la entidad ensamblar
features = [
    "dt_fecha_ensamblar",
    "var_id_rol",
    "var_id_per",
    "var_id_mis"
]
# Creación de un DF para estas características
df = pd.DataFrame(columns=features)

# Determinar fecha para ensamblar
def fechFab_gen():
    """
    Función para crear fecha de fabricación
    ...
    
    Return
    ------
    faker.date_between('-3y') : obj datetime.date
        generación de una fecha entre 3 años antes hasta la fecha actual
    """
    return faker.date_between('-3y')

df['dt_fecha_ensamblar'] = [fechFab_gen() for i in range(num_ensamblar)]

# Fk "Id_rol"
def idr_gen(n):
    """
    Función que se encarga de crear un id unico con nomenclatura básica
    ...
    
    Return
    ------
    "ROL "+str(n+1) : str
        id generado con nomenclatura
    """
    return "ROL "+str(n+1) # id para rol

#Generacion de datos en cada atributo
df['var_id_rol'] = [idr_gen(i) for i in range(num_ensamblar)]

# Fk "Id_per"
def idm_gen(n):
    """
    Función que se encarga de crear un id unico con nomenclatura básica
    ...
    
    Parametros
    ----------
    n : int
        representa el numero de indice correspondiente al registro
    
    Return
    ------
    "PRS "+str(n+1) : str
        nomenclatura única de identificación del permiso correspondiente
    """
    return "PRS "+str(n+1)

df['var_id_per'] = [idm_gen(i) for i in range(num_ensamblar)]

# Fk "Id_mis"
def idm_gen(n):
    """
    Función que se encarga de crear un id unico con nomenclatura básica
    ...
    
    Parametros
    ----------
    n : int
        representa el numero de indice correspondiente al registro
    
    Return
    ------
    "MSL "+str(n+1) : str
        nomenclatura única de identificación del misil correspondiente
    """
    return "MSL "+str(n+1)

df['var_id_mis'] = [idm_gen(i) for i in range(num_ensamblar)]

# Guardar el conjunto de datos
df.to_csv('dataset_ensamblar.csv')

# Mostrar el conjunto de datos
pd.read_csv('dataset_ensamblar.csv', index_col=0)